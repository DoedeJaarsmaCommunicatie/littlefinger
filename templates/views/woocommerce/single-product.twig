{% extends 'base/app.twig' %}
{% from "macro/add-to-cart.twig" import add_to_cart %}

{% block content %}
    {% do action('woocommerce_before_single_product') %}
    <main class="product container mx-auto">
        <img src="{{ post.thumbnail.src('large') }}" alt="{{ post.thumbnail.alt }}" class="product-image" />

        <h1 class="product-title">{{ post.title }}</h1>

        <section class="product-attributes content">
            <h3 class="mb-2">Kenmerken</h3>
            <p class="product-attributes_category">Categorie: {{ fn('wc_get_product_category_list', post.ID) }}</p>
            {% for attribute in product.get_attributes %}
                {% if attribute.get_visible %}
                    {% set _attributes = fn('get_the_terms', post.ID, attribute.get_name) %}
                    <p class="product-attributes_{{ attribute.get_name|replace({'pa_': ''}) }}">
                        {{ attribute.get_name|replace({'pa_': ''})|capitalize }}:
                        {% for _attribute in _attributes %}
                            <span data-attribute="{{ attribute.get_name|replace({'pa_': ''}) }}" data-value="{{ _attribute.slug }}">{{ _attribute.name }}{% if not loop.last %},{% endif %} </span>
                        {% endfor %}
                    </p>
                {% endif %}
            {% endfor %}
        </section>

        <span class="product-price">
            &euro; {{ product.get_price }}
            <small class="product-price_small" hidden>per fles</small>
        </span>

        <section class="product-content">
            {{ post.content }}
        </section>

        {{ add_to_cart(product.get_id, 'product-form') }}
    </main>

    <section class="mt-4">
        {% include 'partials/blocks/products.twig' with { posts: related_products, title: 'Gerelateerde producten' } only %}
    </section>

    {{ add_to_cart(product.get_id, 'product-add-to-cart-container', 'qty') }}
{% endblock %}
